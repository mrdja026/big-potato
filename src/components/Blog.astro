---
import { getCollection } from "astro:content";

const blogPosts = await getCollection("blog");
---

<section id="blog" class="py-24 border-t border-border px-4 sm:px-6 lg:px-8">
  <div class="mx-auto max-w-4xl">
    <div class="flex items-baseline justify-between mb-12">
      <h2 class="text-xl font-semibold tracking-tight">Latest posts</h2>
      <a
        href="/blog"
        class="text-sm text-muted-foreground hover:text-primary transition-colors"
      >
        View all →
      </a>
    </div>

    <div class="grid md:grid-cols-2 gap-8">
      {
        blogPosts.map((post) => (
          <article class="bg-transparent border border-border hover:border-primary/50 transition-colors rounded-lg p-6">
            <div class="space-y-3 pb-3">
              <div class="flex items-center gap-2 text-xs text-muted-foreground font-mono">
                <span>
                  {new Date(post.data.published_at).toLocaleDateString(
                    "en-US",
                    { month: "numeric", day: "numeric", year: "numeric" }
                  )}
                </span>
                <span>·</span>
                <span>5 min read</span>
              </div>
              <h3 class="font-medium text-lg leading-snug">
                <a
                  href={`/blog/${post.data.slug || post.slug}`}
                  class="hover:text-primary transition-colors"
                >
                  {post.data.title}
                </a>
              </h3>
              <p class="text-sm text-muted-foreground leading-relaxed">
                {post.data.excerpt}
              </p>
            </div>
            <div class="space-y-4 pt-0">
              <div class="flex flex-wrap gap-1.5">
                {post.data.tags?.slice(0, 4).map((tag: string) => (
                  <span class="text-xs font-normal bg-secondary/50 text-foreground px-2 py-1 rounded-full">
                    {tag}
                  </span>
                ))}
                {post.data.tags && post.data.tags.length > 4 && (
                  <span class="text-xs font-normal bg-secondary/50 text-foreground px-2 py-1 rounded-full">
                    +{post.data.tags.length - 4}
                  </span>
                )}
              </div>
              <div class="flex items-center gap-2 text-xs text-muted-foreground">
                <div class="w-5 h-5 rounded-full bg-primary/10 flex items-center justify-center font-mono text-primary text-[10px]">
                  MS
                </div>
                <span>Mrdjan Stajic</span>
              </div>
            </div>
          </article>
        ))
      }
    </div>
  </div>
</section>
